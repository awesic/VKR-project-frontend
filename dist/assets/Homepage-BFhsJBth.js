import{r,u as q,j as e,c as V,a as J,b as o,d as K,B as h,C as M,e as X,g as k,f as y,h as Y,L as v,i as Z,k as ee,N as se,o as ae}from"./index-GvI2urAZ.js";import{P as F,a as L,C as ne,b as T,c as R,d as _,e as D,f as P,g as B,h as te,D as I,i as A,j as O,k as z,l as E,m as H,n as $}from"./popover-9d1hG6de.js";import{L as S}from"./loader-2-tsgD-EsW.js";const G=r.forwardRef(({bsPrefix:s,bg:a="primary",pill:n=!1,text:i,className:t,as:l="span",...c},d)=>{const p=q(s,"badge");return e.jsx(l,{ref:d,...c,className:V(t,p,n&&"rounded-pill",i&&`text-${i}`,a&&`bg-${a}`)})});G.displayName="Badge";const b=G;/**
 * @license lucide-react v0.295.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=J("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]),x=r.forwardRef(({className:s,...a},n)=>e.jsx("div",{ref:n,className:o("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a}));x.displayName="Card";const j=r.forwardRef(({className:s,...a},n)=>e.jsx("div",{ref:n,className:o("flex flex-col space-y-1.5 p-6",s),...a}));j.displayName="CardHeader";const u=r.forwardRef(({className:s,...a},n)=>e.jsx("h3",{ref:n,className:o("text-2xl font-semibold leading-none tracking-tight",s),...a}));u.displayName="CardTitle";const C=r.forwardRef(({className:s,...a},n)=>e.jsx("p",{ref:n,className:o("text-sm text-muted-foreground",s),...a}));C.displayName="CardDescription";const f=r.forwardRef(({className:s,...a},n)=>e.jsx("div",{ref:n,className:o("p-6 pt-0",s),...a}));f.displayName="CardContent";const m=r.forwardRef(({className:s,...a},n)=>e.jsx("div",{ref:n,className:o("flex items-center p-6 pt-0",s),...a}));m.displayName="CardFooter";const Q=r.forwardRef(({className:s,...a},n)=>e.jsx("textarea",{className:o("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...a}));Q.displayName="Textarea";const re=({preferTeacher:s,setPreferTeacher:a})=>{var c;const[n,i]=r.useState(!1),{data:t,isLoading:l}=K();return e.jsxs(F,{open:n,onOpenChange:i,children:[e.jsx(L,{asChild:!0,children:e.jsxs(h,{variant:"outline",role:"combobox",className:o("min-w-min justify-between",!s&&"text-muted-foreground"),children:[s?(c=t==null?void 0:t.find(d=>d.id===s))==null?void 0:c.fio:"Выберите преподавателя...",e.jsx(ne,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(T,{className:"min-w-[16rem] p-0",children:e.jsxs(R,{children:[e.jsx(_,{placeholder:"Поиск..."}),e.jsx(D,{children:"Ничего не найдено."}),l?e.jsxs("div",{className:"inline-flex items-center justify-center w-full my-3",children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),e.jsx("span",{children:"Загрузка"})]}):e.jsx(e.Fragment,{children:e.jsx(P,{children:t==null?void 0:t.map(d=>e.jsxs(B,{value:d.fio,onSelect:()=>{a(d.id),i(!1)},children:[e.jsx(M,{className:o("mr-2 h-4 w-4",d.id===s?"opacity-100":"opacity-0")}),d.fio]},d.id))})})]})})]})},ie=({status:s,onStatusSelect:a,disabled:n})=>{const[i,t]=r.useState(!1),{data:l}=X(),[c,d]=r.useState({id:s.id,label:s.label,icon:k(s.id)}),[p,U]=r.useState(null);return r.useEffect(()=>{(async()=>{l&&U(l.map(N=>({...N,icon:k(N.id)})))})()},[l]),e.jsxs(F,{open:i,onOpenChange:t,children:[e.jsx(L,{asChild:!0,children:e.jsx(h,{disabled:n,variant:"outline",className:"justify-start border-2",children:c?e.jsxs(e.Fragment,{children:[e.jsx(c.icon,{className:"mr-2 h-4 w-4 shrink-0"}),c.label]}):e.jsx(e.Fragment,{children:"+ Set status"})})}),e.jsx(T,{className:"p-0",side:"right",align:"start",children:e.jsxs(R,{children:[e.jsx(_,{placeholder:"Поменять статус..."}),e.jsxs(te,{children:[e.jsx(D,{children:"Ничего не найдено."}),e.jsx(P,{children:p==null?void 0:p.map(g=>e.jsxs(B,{value:g.id,onSelect:N=>{d(p.find(W=>W.id===N)||null),a(N),t(!1)},children:[e.jsx(g.icon,{className:o("mr-2 h-4 w-4",g.id===(c==null?void 0:c.id)?"opacity-100":"opacity-40")}),e.jsx("span",{children:g.label})]},g.label))})]})]})})]})},le=({user:s})=>{const[a,n]=r.useState(""),{mutate:i,isPending:t}=y(),l=r.useCallback(()=>{a&&a!==s.theme&&i({theme:a})},[a]);return e.jsx(e.Fragment,{children:e.jsxs(x,{className:"h-min",children:[e.jsx(j,{children:e.jsx(u,{children:"Тема ВКР"})}),e.jsx(f,{children:e.jsxs("div",{className:"flex justify-content-between",children:[s.theme?s.theme:"Введите тему ↙️",s.theme_approved?e.jsx("div",{className:"min-h-min",children:e.jsx(b,{pill:!0,className:"bg-success-subtle border border-success-subtle text-success-emphasis",children:"Утверждена"})}):e.jsx("div",{className:"min-h-min",children:e.jsx(b,{pill:!0,className:"bg-warning-subtle border border-warning-subtle text-warning-emphasis",children:"Не утверждена"})})]})}),e.jsx(m,{children:e.jsxs(I,{children:[e.jsx(A,{asChild:!0,children:e.jsx(h,{className:"hover:bg-neutral-950 hover:text-primary-foreground",variant:"outline",children:"Изменить"})}),e.jsxs(O,{className:"sm:max-w-[425px]",children:[e.jsx(z,{children:e.jsx(E,{children:"Изменить тему"})}),e.jsxs("div",{className:"py-4 items-center",children:[e.jsx(Y,{}),e.jsx(Q,{autoFocus:!0,name:"theme",placeholder:s.theme?s.theme:"Введите тему...",defaultValue:s.theme,className:"col-span-3",onChange:c=>n(c.target.value)})]}),e.jsx(H,{children:e.jsx($,{asChild:!0,children:e.jsxs(h,{type:"button",disabled:t,onClick:l,children:[t?e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Сохранить"]})})})]})]})})]})})},ce=({user:s})=>{const[a,n]=r.useState(s.prefer_teacher?s.prefer_teacher:void 0),{mutate:i,isPending:t}=y(),l=r.useCallback(()=>{a&&a!==s.prefer_teacher&&i({prefer_teacher:a})},[a]);return e.jsx(e.Fragment,{children:e.jsxs(x,{className:"h-min",children:[e.jsxs(j,{children:[e.jsx(u,{children:"Научный руководитель"}),e.jsx(C,{children:"*Нельзя изменить преподавателя после его утверждения."})]}),e.jsx(f,{children:e.jsxs("div",{className:"flex justify-content-between",children:[s.teacher_fullname?s.teacher_fullname:"Выберите преподавателя ↙️",s.teacher_approved?e.jsx("div",{className:"min-h-min",children:e.jsx(b,{pill:!0,className:"bg-success-subtle border border-success-subtle text-success-emphasis",children:"Утвержден"})}):e.jsx("div",{className:"min-h-min",children:e.jsx(b,{pill:!0,className:"bg-warning-subtle border border-warning-subtle text-warning-emphasis",children:"Не утвержден"})})]})}),e.jsx(m,{children:e.jsx(m,{children:e.jsxs(I,{children:[e.jsx(A,{asChild:!0,children:e.jsx(h,{disabled:s.teacher_approved,className:"hover:bg-neutral-950 hover:text-primary-foreground",variant:"outline",children:"Изменить"})}),e.jsxs(O,{className:"sm:max-w-[425px]",children:[e.jsx(z,{children:e.jsx(E,{children:"Выбрать научного руководителя"})}),e.jsx("div",{className:"py-3 items-center flex justify-center",children:e.jsx(re,{preferTeacher:a,setPreferTeacher:n})}),e.jsx(H,{children:e.jsx($,{asChild:!0,children:e.jsxs(h,{type:"button",disabled:t,onClick:l,children:[t?e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Сохранить"]})})})]})]})})})]})})},de=({user:s})=>{const a={id:s.status,label:s.status_label},{mutate:n}=y(),i=t=>{t&&t!==s.status&&n({status:t})};return e.jsx(e.Fragment,{children:e.jsxs(x,{children:[e.jsxs(j,{children:[e.jsx(u,{children:"Статус выполнения ВКР"}),s.teacher_approved?e.jsx(C,{children:"*Этапы упорядочены по мере завершённости."}):e.jsx(C,{children:"*Изменение статуса доступно только после утверждения преподавателя."})]}),e.jsx(f,{children:e.jsx("div",{className:"flex justify-center",children:e.jsx(ie,{status:a,onStatusSelect:i,disabled:!s.teacher_approved})})})]})})},oe=()=>e.jsxs(x,{className:"h-min",children:[e.jsx(j,{children:e.jsx(u,{children:"Выбрать студентов"})}),e.jsx(f,{className:"text-neutral-600",children:"Список студентов, которые выбрали Вас научным руководителем"}),e.jsx(m,{children:e.jsx(v,{to:"/teacher/choose-student",children:e.jsxs(h,{variant:"outline",className:"text-lg",size:"lg",children:["Перейти ",e.jsx(w,{className:"ml-3"})]})})})]}),he=()=>e.jsxs(x,{className:"h-min",children:[e.jsx(j,{children:e.jsx(u,{children:"Список студентов"})}),e.jsx(f,{className:"text-neutral-600",children:"Список студентов, которых Вы выбрали"}),e.jsx(m,{children:e.jsx(v,{to:"/teacher/students-list",children:e.jsxs(h,{variant:"outline",className:"text-lg",size:"lg",children:["Перейти ",e.jsx(w,{className:"ml-3"})]})})})]}),me=()=>e.jsxs(x,{className:"h-min",children:[e.jsx(j,{children:e.jsx(u,{children:"Список преподавателей"})}),e.jsx(m,{children:e.jsx(v,{to:"/admin/teachers",children:e.jsxs(h,{variant:"outline",className:"text-lg",size:"lg",children:["Перейти ",e.jsx(w,{className:"ml-3"})]})})})]}),xe=()=>e.jsxs(x,{className:"h-min",children:[e.jsx(j,{children:e.jsx(u,{children:"Список студентов"})}),e.jsx(m,{children:e.jsx(v,{to:"/admin/students",children:e.jsxs(h,{variant:"outline",className:"text-lg",size:"lg",children:["Перейти ",e.jsx(w,{className:"ml-3"})]})})})]});function ge(){var t,l;const{data:s}=Z(),a=e.jsxs(e.Fragment,{children:[e.jsx(le,{user:s}),e.jsx(ce,{user:s}),e.jsx(de,{user:s})]}),n=e.jsxs(e.Fragment,{children:[e.jsx(oe,{}),e.jsx(he,{})]}),i=e.jsxs(e.Fragment,{children:[e.jsx(me,{}),e.jsx(xe,{})]});return e.jsx(ee,{title:"Главная",content:"Главная страница",children:e.jsxs(r.Fragment,{children:[e.jsx(se,{}),e.jsx("div",{className:"container mt-4",children:e.jsx("div",{className:"gap-4 grid grid-cols-1 md:grid-cols-2",children:((t=s==null?void 0:s.role)==null?void 0:t.toString().toLowerCase())==="student"?a:((l=s==null?void 0:s.role)==null?void 0:l.toString().toLowerCase())==="teacher"?n:i})}),e.jsx(ae,{richColors:!0,closeButton:!0,toastOptions:{duration:1e3*5}})]})})}export{ge as default};
